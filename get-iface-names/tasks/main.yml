# (c) 2016 DataNexus Inc.  All Rights Reserved
---
# first, get a list of the IP addresses and the corresponding list of network
# names for each host
- set_fact:
    lcl_host_facts: "{{hostvars[inventory_hostname]}}"
    lcl_iface_info_keys: "{{hostvars[inventory_hostname].ansible_interfaces | map('regex_replace', '^(.*)$', 'ansible_\\1' ) | list}}"
- set_fact:
    lcl_iface_names: "{{lcl_host_facts.ansible_interfaces}}"
    lcl_iface_addresses: "{{lcl_iface_info_keys | map('extract', lcl_host_facts, ['ipv4', 'address']) | list}}"
# then, for each of the interface description values that were passed in,
# determine what should be returned based on the 'type' in that description
# (currently either 'cidr' or 'name' are supported by this role)
- include: ../files/set_return_vals.yml
  with_items: "{{iface_descriptions}}"
  loop_control:
    loop_var: iface_description